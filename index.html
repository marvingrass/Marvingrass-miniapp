<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Marvingrass Exchange</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
* {
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
}

body {
    background: linear-gradient(135deg, #0f172a, #020617);
    color: white;
    padding: 20px;
}

.container {
    max-width: 420px;
    margin: auto;
}

.card {
    background: rgba(30, 41, 59, 0.7);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    padding: 20px;
    margin-top: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.4);
    animation: fadeIn 0.4s ease;
}

h1 {
    text-align:center;
    font-size:22px;
    margin-bottom:5px;
}

.subtitle {
    text-align:center;
    color:#94a3b8;
    font-size:14px;
    margin-bottom:20px;
}

.switch {
    display:flex;
    background:#020617;
    border-radius:12px;
    padding:5px;
    margin-bottom:20px;
}

.switch button {
    flex:1;
    border:none;
    background:none;
    color:#64748b;
    padding:10px;
    font-size:15px;
    border-radius:10px;
    transition:0.3s;
}

.switch .active {
    background:#3b82f6;
    color:white;
    box-shadow: 0 0 15px rgba(59,130,246,0.5);
}

.label {
    font-size:13px;
    color:#94a3b8;
    margin-bottom:6px;
}

input, select {
    width:100%;
    padding:14px;
    border-radius:12px;
    border:none;
    margin-bottom:15px;
    font-size:16px;
    background:#020617;
    color:white;
}

.rateBox {
    background:#020617;
    border-radius:12px;
    padding:15px;
    margin-bottom:15px;
    text-align:center;
}

.rate {
    font-size:18px;
    font-weight:bold;
    color:#22c55e;
}

.submit {
    width:100%;
    padding:16px;
    border:none;
    border-radius:14px;
    background: linear-gradient(135deg, #22c55e, #16a34a);
    color:white;
    font-size:17px;
    font-weight:bold;
    transition:0.3s;
}

.submit:active {
    transform: scale(0.97);
}

.footer {
    text-align:center;
    margin-top:20px;
    font-size:12px;
    color:#475569;
}

@keyframes fadeIn {
    from { opacity:0; transform: translateY(10px); }
    to { opacity:1; transform: translateY(0); }
}
</style>
</head>

<body>

<div class="container">
    <div class="card">

        <h1>Marvingrass Exchange</h1>
        <div class="subtitle">–û–±–º–µ–Ω –≤–∞–ª—é—Ç ‚Ä¢ USDT ‚Ä¢ RUB ‚Ä¢ KZT</div>

        <div class="switch">
            <button id="buyBtn" class="active" onclick="setType('buy')">–ö—É–ø–∏—Ç—å</button>
            <button id="sellBtn" onclick="setType('sell')">–ü—Ä–æ–¥–∞—Ç—å</button>
        </div>

        <div class="label">–°—É–º–º–∞</div>
        <input id="amount" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" oninput="calculate()">

        <div class="label">–û—Ç–¥–∞—ë—Ç–µ</div>
        <select id="from" onchange="calculate()">
            <option value="RUB">RUB</option>
            <option value="KZT">KZT</option>
            <option value="USDT">USDT</option>
        </select>

        <div class="label">–ü–æ–ª—É—á–∞–µ—Ç–µ</div>
        <select id="to" onchange="calculate()">
            <option value="USDT">USDT</option>
            <option value="RUB">RUB</option>
            <option value="KZT">KZT</option>
        </select>

        <div class="rateBox">
            <div>–û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π –∫—É—Ä—Å</div>
            <div class="rate" id="rate">‚Äî</div>
        </div>

        <button class="submit" onclick="sendRequest()">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</button>

    </div>

    <div class="footer">
        –û–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç –∫—É—Ä—Å –≤—Ä—É—á–Ω—É—é
    </div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

let type = "buy";

// üî• –¢–£–¢ –ú–ï–ù–Ø–ï–®–¨ –°–í–û–ò –ö–£–†–°–´
const rates = {
    RUB_USDT: 120,
    KZT_USDT: 525,
    USDT_RUB: 118,
    USDT_KZT: 520
};

function setType(t) {
    type = t;
    document.getElementById("buyBtn").classList.remove("active");
    document.getElementById("sellBtn").classList.remove("active");

    if(t === "buy") document.getElementById("buyBtn").classList.add("active");
    else document.getElementById("sellBtn").classList.add("active");

    calculate();
}

function calculate() {
    const amount = document.getElementById("amount").value;
    const from = document.getElementById("from").value;
    const to = document.getElementById("to").value;

    if(!amount) {
        document.getElementById("rate").innerText = "‚Äî";
        return;
    }

    let result = 0;

    if(from === "RUB" && to === "USDT") result = amount / rates.RUB_USDT;
    else if(from === "KZT" && to === "USDT") result = amount / rates.KZT_USDT;
    else if(from === "USDT" && to === "RUB") result = amount * rates.USDT_RUB;
    else if(from === "USDT" && to === "KZT") result = amount * rates.USDT_KZT;
    else result = amount;

    document.getElementById("rate").innerText =
        result.toFixed(2) + " " + to;
}

function sendRequest() {
    const amount = document.getElementById("amount").value;
    const from = document.getElementById("from").value;
    const to = document.getElementById("to").value;

    if(!amount) {
        alert("–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É");
        return;
    }

    const data = {
        type: type,
        amount: amount,
        from: from,
        to: to
    };

    tg.sendData(JSON.stringify(data));
    alert("‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä—É");
}
</script>

</body>
</html>